<UserControl x:Class="ccc.Controls.Visuals.PageBanner"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ccc.Controls.Visuals"
             mc:Ignorable="d" 
             d:DesignHeight="220" d:DesignWidth="800">
    <Grid Height="220" ClipToBounds="True">
        <!-- Unified Background (Top Slice) -->
        <local:UnifiedBannerBackground 
            ImageSource="{Binding BannerImage, RelativeSource={RelativeSource AncestorType=UserControl}}"
            BannerTotalHeight="280" 
            VerticalOffset="0"/>
        
        <!-- Gradient Overlay for Contrast -->
        <Border>
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                    <GradientStop Color="#CC0F172A" Offset="0"/>
                    <GradientStop Color="#660F172A" Offset="0.6"/>
                    <GradientStop Color="Transparent" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <Grid Margin="24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/> <!-- Avatar -->
                <ColumnDefinition Width="*"/>    <!-- Text -->
                <ColumnDefinition Width="Auto"/> <!-- Continue Watching -->
            </Grid.ColumnDefinitions>

            <!-- ASCII Avatar (Placeholder) -->
            <Border Grid.Column="0" Width="120" Height="120" VerticalAlignment="Center" Margin="0,0,24,0"
                    BorderBrush="White" BorderThickness="1" CornerRadius="4">
                <TextBlock Text="{Binding AvatarAscii, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                           FontFamily="Consolas, monospace" FontSize="10" Foreground="White" 
                           HorizontalAlignment="Center" VerticalAlignment="Center" TextAlignment="Center"/>
            </Border>

            <!-- Text Content -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock Text="{Binding Title, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                           FontSize="32" FontWeight="Bold" Foreground="White" TextTrimming="CharacterEllipsis"/>
                
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                    <TextBlock Text="{Binding VideoCountText, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                               Foreground="#CBD5E1" FontSize="14" Margin="0,0,12,0"/>
                    <TextBlock Text="•  2026" Foreground="#94A3B8" FontSize="14" Margin="0,0,12,0"/>
                    <TextBlock Text="{Binding AuthorName, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                               Foreground="#94A3B8" FontSize="14"/>
                </StackPanel>

                <TextBlock Text="{Binding Description, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                           Foreground="#E2E8F0" FontSize="14" Margin="0,12,0,0"
                           TextWrapping="Wrap" MaxHeight="44" TextTrimming="CharacterEllipsis" Opacity="0.9"/>
            </StackPanel>

            <!-- Continue Watching (Top Right) -->
            <Grid Grid.Column="2" VerticalAlignment="Top" Margin="24,0,0,0"
                  Visibility="{Binding HasContinueWatching, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Border CornerRadius="8" BorderBrush="{StaticResource TextPrimaryBrush}" BorderThickness="1" Padding="2" Background="#1E293B">
                    <StackPanel>
                        <TextBlock Text="CONTINUE?" FontSize="10" FontWeight="Bold" Foreground="{StaticResource BgPrimaryBrush}" Margin="2" HorizontalAlignment="Center"/>
                        <Image Source="{Binding ContinueWatchingThumbnail, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                               Width="120" Height="67" Stretch="UniformToFill"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>

        <!-- Edit Button (Top Left) -->
        <Button HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8" Style="{StaticResource InvisibleBtn}"
                Visibility="{Binding CanEdit, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="✎" Foreground="White" Opacity="0.5"/>
        </Button>

    </Grid>
</UserControl>
